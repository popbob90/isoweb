// Translations
const translations = {
    en: {
        nav_features: "Features",
        nav_digisign: "Digital Sign",
        nav_community: "Community",
        nav_get_started: "Get Started",
        hero_badge: "ISO MANAGEMENT SYSTEM",
        hero_title: "The Future of <br><span class='gradient-text'>Quality Management</span>",
        hero_desc: "Seamless ISO compliance, advanced document control, and secure digital signatures. All in one open-source platform.",
        btn_download: "Join Demo Now",
        btn_star: "Contact Us",
        card_status: "Document Signed Successfully",
        card_signed_by: "Digitally Signed by",
        card_manager: "Manager",
        card_valid: "Valid",
        features_title: "Engineered for <span class='highlight'>Excellence</span>",
        features_desc: "Everything you need to maintain ISO standards without the headache.",
        feat_1_title: "Web-based SaaS & Zero Installation",
        feat_1_desc: "As a web-base application, QMS requires no client-side software installation.",
        feat_2_title: "Flexible Modular Approach",
        feat_2_desc: "The system designed with a modular approach. Easy to use and scale.",
        feat_3_title: "Comprehensive Document Management",
        feat_3_desc: "A centralized repository providing complete control over the document lifecycle.",
        feat_4_title: "Integrated Audit & CAPA Management",
        feat_4_desc: "Supports various types of audits and directly links findings to CAPA.",
        feat_5_title: "Robust Risk Management",
        feat_5_desc: "Tools to identify, analyze, and mitigate risks across the organization.",
        feat_6_title: "Automated Workflows & Notifications",
        feat_6_desc: "Automates workflow processes and sends email alerts for pending tasks.",
        feat_7_title: "Multi-Location & Multi-Standard Support",
        feat_7_desc: "Manages data from multiple branches and integrates various ISO standards.",
        feat_8_title: "High Customizability with Dynamic Forms",
        feat_8_desc: "Allows non-technical users to design Dynamic Forms for data collection.",
        feat_9_title: "Real-time Dashboards & Reporting",
        feat_9_desc: "Visual insights into QMS performance through interactive dashboards.",
        feat_10_title: "Training Management",
        feat_10_desc: "Tracks and manages employee training records and competence.",
        spotlight_title: "Seamless <span class='gradient-text'>Approval Experience</span>",
        spotlight_desc: "It's time to say goodbye to cumbersome printing and scanning processes. We simplify document approval with an intuitive electronic signature workflow while securely storing all transaction history.",
        spotlight_li_1: "Streamline your approval process with just a few clicks directly in your browser.",
        spotlight_li_2: "Secure storage of all signing history and transaction records for complete auditability.",
        spotlight_li_3: "Flexible support for advanced digital signature standards when needed.",
        spotlight_li_4: "Enjoy a smooth interface that completes signing in just a few clicks, directly in the browser.",
        btn_learn_more: "Learn More",
        cta_title: "Ready to Transform Your QMS?",
        cta_desc: "Join thousands of users managing quality with QMS.",
        btn_demo: "Join demo now",
        btn_docs: "View Documentation",
        footer_tagline: "Open Source Quality Management System.",
        footer_resources: "Resources",
        footer_docs: "Documentation",
        footer_api: "API Reference",
        footer_forum: "Community Forum",
        footer_project: "Project",
        footer_issues: "Issues",
        footer_roadmap: "Roadmap",
        footer_connect: "Connect",
        footer_copyright: "Open Source under MIT License."
    },
    vn: {
        nav_features: "Tính năng",
        nav_digisign: "Ký duyệt",
        nav_community: "Cộng đồng",
        nav_get_started: "Bắt đầu",
        hero_badge: "HỆ THỐNG QUẢN LÝ ISO",
        hero_title: "Tương lai của <br><span class='gradient-text'>Quản lý Chất lượng</span>",
        hero_desc: "Tuân thủ ISO liền mạch, kiểm soát tài liệu tiên tiến và chữ ký số bảo mật. Tất cả trong một nền tảng mã nguồn mở.",
        btn_download: "Login demo",
        btn_star: "Liên hệ",
        card_status: "Tài liệu đã ký thành công",
        card_signed_by: "Ký số bởi",
        card_manager: "Quản lý",
        card_valid: "Hợp lệ",
        features_title: "Được thiết kế cho <span class='highlight'>Sự xuất sắc</span>",
        features_desc: "Mọi thứ bạn cần để duy trì tiêu chuẩn ISO mà không gặp rắc rối.",
        feat_1_title: "Ứng dụng trên nền Web & Không cần Cài đặt",
        feat_1_desc: "Là ứng dụng trên nền Web, QMS không yêu cầu cài đặt phần mềm phía client.",
        feat_2_title: "Phương pháp Module linh hoạt",
        feat_2_desc: "Hệ thống được thiết kế theo phương pháp module. Dễ dàng sử dụng và mở rộng",
        feat_3_title: "Quản lý Tài liệu toàn diện",
        feat_3_desc: "Kho lưu trữ tập trung cung cấp quyền kiểm soát hoàn toàn vòng đời tài liệu.",
        feat_4_title: "Quản lý Kiểm toán & CAPA tích hợp",
        feat_4_desc: "Hỗ trợ nhiều loại kiểm toán và liên kết trực tiếp các phát hiện với CAPA.",
        feat_5_title: "Quản lý Rủi ro mạnh mẽ",
        feat_5_desc: "Công cụ để xác định, phân tích và giảm thiểu rủi ro trong toàn tổ chức.",
        feat_6_title: "Quy trình tự động & Thông báo",
        feat_6_desc: "Tự động hóa quy trình làm việc và gửi cảnh báo email cho các công việc đang chờ xử lý.",
        feat_7_title: "Hỗ trợ Đa địa điểm & Đa tiêu chuẩn",
        feat_7_desc: "Quản lý dữ liệu từ nhiều chi nhánh và tích hợp các tiêu chuẩn ISO khác nhau.",
        feat_8_title: "Tùy chỉnh cao với Biểu mẫu động",
        feat_8_desc: "Cho phép người dùng không có kỹ thuật thiết kế Biểu mẫu động để thu thập dữ liệu.",
        feat_9_title: "Bảng điều khiển & Báo cáo Thời gian thực",
        feat_9_desc: "Thông tin chi tiết trực quan về hiệu suất QMS thông qua bảng điều khiển tương tác.",
        feat_10_title: "Quản lý Đào tạo",
        feat_10_desc: "Theo dõi và quản lý hồ sơ đào tạo và năng lực của nhân viên.",
        spotlight_title: "Trải nghiệm <span class='gradient-text'>Ký duyệt không gián đoạn</span>",
        spotlight_desc: "Đã đến lúc nói lời tạm biệt với quy trình in ấn và scan rườm rà. Chúng tôi đơn giản hóa việc phê duyệt tài liệu bằng quy trình ký điện tử trực quan, đồng thời lưu trữ bảo mật mọi lịch sử giao dịch.",
        spotlight_li_1: "Hoàn tất việc ký duyệt chỉ trong vài cú nhấp chuột, trực tiếp trên trình duyệt.",
        spotlight_li_2: "Lưu trữ an toàn toàn bộ lịch sử ký và hồ sơ giao dịch để kiểm tra đầy đủ.",
        spotlight_li_3: "Hỗ trợ linh hoạt các chuẩn ký số nâng cao khi cần thiết.",
        spotlight_li_4: "Tận hưởng giao diện mượt mà giúp bạn hoàn tất việc ký duyệt chỉ trong vài cú nhấp chuột.",
        btn_learn_more: "Tìm hiểu thêm",
        cta_title: "Sẵn sàng Chuyển đổi QMS của bạn?",
        cta_desc: "Tham gia cùng hàng ngàn người dùng quản lý chất lượng với QMS.",
        btn_download_v23: "Tải v2.3",
        btn_demo: "Đăng nhập demo",
        btn_docs: "Xem Tài liệu",
        footer_tagline: "Hệ thống Quản lý Chất lượng Mã nguồn mở.",
        footer_resources: "Tài nguyên",
        footer_docs: "Tài liệu",
        footer_api: "Tham chiếu API",
        footer_forum: "Diễn đàn Cộng đồng",
        footer_project: "Dự án",
        footer_issues: "Vấn đề",
        footer_roadmap: "Lộ trình",
        footer_connect: "Kết nối",
        footer_copyright: "Mã nguồn mở theo Giấy phép MIT."
    }
};

let currentLang = 'vn';

function setLanguage(lang) {
    currentLang = lang;
    const btns = document.querySelectorAll('.lang-btn');
    btns.forEach(b => b.classList.remove('active'));
    if (lang === 'en' && btns[0]) btns[0].classList.add('active');
    if (lang === 'vn' && btns[1]) btns[1].classList.add('active');
    document.querySelectorAll('[data-i18n]').forEach(element => {
        const key = element.getAttribute('data-i18n');
        if (translations[lang][key]) {
            element.innerHTML = translations[lang][key];
        }
    });
}
setLanguage('vn');

// Cursor glow effect
const cursorGlow = document.querySelector('.cursor-glow');
document.addEventListener('mousemove', (e) => {
    cursorGlow.style.left = e.clientX + 'px';
    cursorGlow.style.top = e.clientY + 'px';
});

// Scroll animations
const observerOptions = {
    threshold: 0.1,
    rootMargin: '0px 0px -100px 0px'
};

const observer = new IntersectionObserver((entries) => {
    entries.forEach(entry => {
        if (entry.isIntersecting) {
            entry.target.classList.add('active');
        }
    });
}, observerOptions);

document.querySelectorAll('[data-animate]').forEach(el => {
    observer.observe(el);
});

const tmSlides = Array.from(document.querySelectorAll('.tm-coverflow .tm-slide'));
let tmIndex = 2;
const TM_N = tmSlides.length;
function tmDelta(i) {
    let d = i - tmIndex;
    const half = Math.floor(TM_N / 2);
    if (d > half) d -= TM_N;
    if (d < -half) d += TM_N;
    return d;
}
function tmRender() {
    tmSlides.forEach((s, i) => {
        const d = tmDelta(i);
        s.classList.remove('tm-pos-0', 'tm-pos-1', 'tm-pos-2', 'tm-pos--1', 'tm-pos--2');
        s.style.opacity = 0;
        if (d === 0) { s.classList.add('tm-pos-0'); s.style.opacity = ''; }
        else if (d === 1) { s.classList.add('tm-pos-1'); s.style.opacity = ''; }
        else if (d === 2) { s.classList.add('tm-pos-2'); s.style.opacity = ''; }
        else if (d === -1) { s.classList.add('tm-pos--1'); s.style.opacity = ''; }
        else if (d === -2) { s.classList.add('tm-pos--2'); s.style.opacity = ''; }
    });
}
tmRender();
const tmPrev = document.querySelector('.tm-prev');
const tmNext = document.querySelector('.tm-next');
tmPrev?.addEventListener('click', () => { tmIndex = (tmIndex - 1 + TM_N) % TM_N; tmRender(); });
tmNext?.addEventListener('click', () => { tmIndex = (tmIndex + 1) % TM_N; tmRender(); });
tmSlides.forEach((s, i) => s.addEventListener('click', () => { tmIndex = i; tmRender(); }));
document.addEventListener('keydown', (e) => {
    if (e.key === 'ArrowLeft') { tmIndex = (tmIndex - 1 + TM_N) % TM_N; tmRender(); }
    if (e.key === 'ArrowRight') { tmIndex = (tmIndex + 1) % TM_N; tmRender(); }
});

// Mobile menu toggle
const mobileToggle = document.querySelector('.mobile-toggle');
const navLinks = document.querySelector('.nav-links');

mobileToggle.addEventListener('click', () => {
    navLinks.style.display = navLinks.style.display === 'flex' ? 'none' : 'flex';
});

// Smooth scrolling
document.querySelectorAll('a[href^="#"]').forEach(anchor => {
    anchor.addEventListener('click', function (e) {
        const href = this.getAttribute('href');
        if (href !== '#') {
            e.preventDefault();
            const target = document.querySelector(href);
            if (target) {
                target.scrollIntoView({
                    behavior: 'smooth',
                    block: 'start'
                });
            }
        }
    });
});

// Login Modal Logic
const loginModal = document.getElementById('loginModal');
const closeButton = document.querySelector('.close-button');
const agreeButton = document.getElementById('agreeButton');
const cancelButton = document.getElementById('cancelButton');
const demoButtons = document.querySelectorAll('.demo-btn');

// Show modal when clicking demo buttons
demoButtons.forEach(button => {
    button.addEventListener('click', function (e) {
        e.preventDefault();
        if (loginModal) {
            loginModal.classList.add('show');
        }
    });
});

// Close modal function
function closeModal() {
    if (loginModal) {
        loginModal.classList.remove('show');
    }
}

// Close button
if (closeButton) {
    closeButton.addEventListener('click', closeModal);
}

// Cancel button
if (cancelButton) {
    cancelButton.addEventListener('click', closeModal);
}

// Agree button - redirect to demo
if (agreeButton) {
    agreeButton.addEventListener('click', function () {
        window.location.href = 'https://iso.senpos.vn/';
    });
}

// Close modal when clicking outside
window.addEventListener('click', function (event) {
    if (event.target == loginModal) {
        closeModal();
    }
});
